# Cloudflare Workers Headers Configuration
# Security-focused headers for Henrik Söderlund's personal website
# React 19.1.1 + Vite 7.1.2 + Hono.js 4.9.1 + Cloudflare Workers

# Preview/Staging Environment - Prevent search engine indexing
https://:project.pages.dev/*
  X-Robots-Tag: noindex
  Access-Control-Allow-Origin: *

/*
  # Security Headers
  X-Frame-Options: SAMEORIGIN
  X-Content-Type-Options: nosniff
  X-XSS-Protection: 1; mode=block
  Referrer-Policy: strict-origin
  
  # Content Security Policy now handled dynamically by Hono worker with nonce support
  # - Dynamic nonce generation for enhanced security
  # - Removes need for 'unsafe-eval' and most 'unsafe-inline' usage
  # - Maintains support for all existing external services
  # Note: CSP headers are now generated server-side with unique nonces per request
  
  # Permissions Policy - Disable unnecessary browser features
  Permissions-Policy: accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(self), geolocation=(), gyroscope=(), keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()
  
  # Strict Transport Security (HTTPS enforcement)
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
  
  # Service Worker Configuration
  Service-Worker-Allowed: /
  
  # Cross-Origin Resource Policy
  Cross-Origin-Resource-Policy: cross-origin
  
  # Global CORS Configuration
  Access-Control-Allow-Origin: *
  Access-Control-Allow-Methods: GET, POST, OPTIONS
  Access-Control-Allow-Headers: *
  Access-Control-Max-Age: 86400
  
  # SEO and Indexing
  X-Robots-Tag: index
  
  # Cache Control for static assets (default)
  Cache-Control: public, max-age=31536000, immutable
  
  # Custom headers for Henrik Söderlund's site
  X-Powered-By: Cloudflare Workers
  X-Site-Tech: React + Vite + Hono + Cloudflare

# Static Assets - Aggressive caching
/assets/*
  Cache-Control: public, max-age=31536000, immutable

# JavaScript and CSS files - Long cache with revalidation
/*.js
  Cache-Control: public, max-age=31536000, immutable
  
/*.css
  Cache-Control: public, max-age=31536000, immutable

# Images - Long cache
/*.jpg
  Cache-Control: public, max-age=31536000, immutable
  
/*.jpeg
  Cache-Control: public, max-age=31536000, immutable
  
/*.png
  Cache-Control: public, max-age=31536000, immutable
  
/*.svg
  Cache-Control: public, max-age=31536000, immutable

/*.webp
  Cache-Control: public, max-age=31536000, immutable

# HTML files - Short cache for dynamic updates
/*.html
  Cache-Control: public, max-age=300, must-revalidate

# Markdown files for LLM consumption - Medium cache
/*.md
  Cache-Control: public, max-age=3600, must-revalidate

# Special files - No cache for dynamic content
/llms.txt
  Cache-Control: public, max-age=3600, must-revalidate

/sitemap.xml
  Cache-Control: public, max-age=3600, must-revalidate

/robots.txt
  Cache-Control: public, max-age=86400, must-revalidate

# Verification files - Long cache
/ahrefs_*
  Cache-Control: public, max-age=31536000, immutable

/google*.html
  Cache-Control: public, max-age=31536000, immutable

# Hono.js API endpoints - Secure headers for backend routes
/api/*
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  X-XSS-Protection: 1; mode=block
  Referrer-Policy: strict-origin-when-cross-origin
  Content-Security-Policy: default-src 'none'; script-src 'none'; style-src 'none'
  Cache-Control: no-store, no-cache, must-revalidate, private
  X-API-Version: 2.0
  Access-Control-Allow-Origin: https://henriksoderlund.com
  Access-Control-Allow-Methods: GET, POST, OPTIONS
  Access-Control-Allow-Headers: Content-Type, Authorization

# React SPA routes - Ensure proper headers for client-side routing
/expertise
  Cache-Control: public, max-age=300, must-revalidate

/work-experience  
  Cache-Control: public, max-age=300, must-revalidate

/education
  Cache-Control: public, max-age=300, must-revalidate

/consultancy
  Cache-Control: public, max-age=300, must-revalidate

# Root route
/
  Cache-Control: public, max-age=300, must-revalidate

# Vite specific assets generated during build
/src/*
  Cache-Control: public, max-age=31536000, immutable

# React specific assets
/react/*
  Cache-Control: public, max-age=31536000, immutable